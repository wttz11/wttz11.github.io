<!doctype html><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.8" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.39" /><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;if (um === 'dark' || (um !== 'light' && sm)) {document.documentElement.classList.add('dark');}})();</script><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><link rel="icon" href="/images/head-circle.jpg"><title>webpack打包流程</title><meta name="description" content=""><link rel="preload" href="/assets/style-BzznhLG_.css" as="style"><link rel="stylesheet" href="/assets/style-BzznhLG_.css"><link rel="modulepreload" href="/assets/app-CVXxSXU1.js"><link rel="modulepreload" href="/assets/index.html-Czf7Vnis.js"><link rel="prefetch" href="/assets/index.html-IO3j29SP.js" as="script"><link rel="prefetch" href="/assets/index.html-CoqXvvC7.js" as="script"><link rel="prefetch" href="/assets/index.html-Dlz4L_BB.js" as="script"><link rel="prefetch" href="/assets/index.html-CWcr5AlW.js" as="script"><link rel="prefetch" href="/assets/index.html-C1FGj7z_.js" as="script"><link rel="prefetch" href="/assets/404.html-BzdO68uZ.js" as="script"><link rel="prefetch" href="/assets/index.html-DGTl63_I.js" as="script"><link rel="prefetch" href="/assets/index.html-BdbaKk5-.js" as="script"><link rel="prefetch" href="/assets/index.html-Bx7lDHR0.js" as="script"></head><body><div id="app"><!--[--><div class="theme-plume" data-v-ccde5b38><!--[--><!--[--><span tabindex="-1" data-v-ab0f771b></span><a href="#LayoutContent" class="skip-link visually-hidden" data-v-ab0f771b> Skip to content </a><!--]--><!----><div class="nav-wrapper" data-v-ccde5b38 data-v-4aa7bc5a><div class="navbar-wrapper" data-v-4aa7bc5a data-v-f397576e><div class="container" data-v-f397576e><div class="title" data-v-f397576e><div class="navbar-title" data-v-f397576e data-v-8c9bd93f><a class="auto-link link title" href="/" data-v-8c9bd93f data-v-92ad409b><!--[--><!----> <!--]--><!----></a></div></div><div class="content" data-v-f397576e><div class="curtain" data-v-f397576e></div><div class="content-body" data-v-f397576e><div class="navbar-search search" data-v-f397576e><!----></div><nav aria-labelledby="main-nav-aria-label" class="navbar-menu menu" data-v-f397576e data-v-a3f1a60e><span id="main-nav-aria-label" class="visually-hidden" data-v-a3f1a60e>Main Navigation</span><!--[--><!--[--><a class="auto-link link navbar-menu-link" href="/" data-v-a3f1a60e data-v-2867d7e1 data-v-92ad409b><!--[--><!----><i data-v-2867d7e1>Home</i><!--]--><!----></a><!--]--><!--[--><a class="auto-link link navbar-menu-link" href="/blog/" data-v-a3f1a60e data-v-2867d7e1 data-v-92ad409b><!--[--><!----><i data-v-2867d7e1>Blog</i><!--]--><!----></a><!--]--><!--]--></nav><!----><div class="navbar-appearance appearance" data-v-f397576e data-v-2e93bdf2><button class="switch-wrapper switch-appearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-2e93bdf2 data-v-44f1284c data-v-bca38222><span class="check" data-v-bca38222><span class="icon" data-v-bca38222><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-44f1284c><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-44f1284c><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="flyout-wrapper navbar-extra extra" data-v-f397576e data-v-82afdbbd data-v-3a9d871b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-3a9d871b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-3a9d871b><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-3a9d871b><div class="menu-wrapper" data-v-3a9d871b data-v-a471995b><!----><!--[--><!--[--><!----><div class="group" data-v-82afdbbd><div class="item appearance" data-v-82afdbbd><p class="label" data-v-82afdbbd>Appearance</p><div class="appearance-action" data-v-82afdbbd><button class="switch-wrapper switch-appearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-82afdbbd data-v-44f1284c data-v-bca38222><span class="check" data-v-bca38222><span class="icon" data-v-bca38222><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-44f1284c><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-44f1284c><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><button type="button" class="navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-f397576e data-v-1925941b><span class="container" data-v-1925941b><span class="top" data-v-1925941b></span><span class="middle" data-v-1925941b></span><span class="bottom" data-v-1925941b></span></span></button></div></div></div></div><!----></div><div class="local-nav fixed reached-top is-blog" data-v-ccde5b38 data-v-9e97fa1e><button class="hidden menu" disabled aria-expanded="false" aria-controls="SidebarNav" data-v-9e97fa1e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-9e97fa1e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-9e97fa1e>Menu</span></button><div class="local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-9e97fa1e data-v-0c2ee5ba><button data-v-0c2ee5ba>Return to top</button><!----></div></div><!----><div id="LayoutContent" class="layout-content" data-v-ccde5b38 data-v-15e802b3><!--[--><div class="plume-page is-blog" data-v-ccde5b38 data-v-6df22fc2><div class="container" data-v-6df22fc2><!----><div class="content" data-v-6df22fc2><div class="content-container" data-v-6df22fc2><main class="main" data-v-6df22fc2><!--[--><div class="page-category-wrapper" data-v-97c7dff6><!--[--><!--[--><span class="category" data-v-97c7dff6>前端</span><span class="dot" data-v-97c7dff6>›</span><!--]--><!--[--><span class="category" data-v-97c7dff6>前端工程化</span><span class="dot" data-v-97c7dff6>›</span><!--]--><!--[--><span class="category" data-v-97c7dff6>webpack</span><!----><!--]--><!--]--></div><h1 class="page-title" data-v-97c7dff6>webpack打包流程</h1><div class="page-meta-wrapper" data-v-97c7dff6><p class="reading-time" data-v-97c7dff6><svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewbox="0 0 512 512" class="icon" data-v-97c7dff6><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 160c16-63.16 76.43-95.41 208-96a15.94 15.94 0 0 1 16 16v288a16 16 0 0 1-16 16c-128 0-177.45 25.81-208 64c-30.37-38-80-64-208-64c-9.88 0-16-8.05-16-17.93V80a15.94 15.94 0 0 1 16-16c131.57.59 192 32.84 208 96m0 0v288"></path></svg><span data-v-97c7dff6>About 777 words</span><span data-v-97c7dff6>About 3 min</span></p><p data-v-97c7dff6><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 20 20" class="icon" data-v-97c7dff6><g fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z"></path></g></svg><!--[--><span class="tag" style="--vp-tag-color:#6aa1b7;--vp-tag-bg-color:rgba(131, 208, 218, 0.314);" data-v-97c7dff6>webpack</span><!--]--></p><p class="create-time" data-v-97c7dff6><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon" data-v-97c7dff6><path fill="currentColor" d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"></path></svg><span data-v-97c7dff6>2023-11-2</span></p></div><!--]--><!--[--><div class="plume-content" data-v-6df22fc2><p>webpack的基础作用是将源代码进行编译后（构建打包，将各个模块的源码以函数的形式，以浏览器能够理解的JavaScript合成到一个文件中）形成最终浏览器代码，包括三个阶 段，<strong>初始化</strong>、<strong>编译</strong>、<strong>输出</strong></p><p><img src="/assets/webpack官网图-B7ZANId0.png" alt=""></p><h1 id="初始化" tabindex="-1"><a class="header-anchor" href="#初始化"><span>初始化</span></a></h1><p>此阶段，webpack会将<strong>CLI参数</strong>、<strong>配置文件</strong>、<strong>默认配置</strong>进行融合，形成一个最终的配置对象。</p><p>对配置的处理过程是依托一个第三方库<code>yargs</code>完成的</p><p>此阶段相对比较简单，主要生成配置对象为接下来的编译阶段做必要的准备</p><h1 id="编译" tabindex="-1"><a class="header-anchor" href="#编译"><span>编译</span></a></h1><ol><li><strong>创建chunk</strong></li></ol><p>chunk是webpack在内部构建过程中的一个概念，译为<code>块</code>，它表示通过某个入口找到的所有依赖的统称。</p><p>根据入口模块（默认为<code>./src/index.js</code>）创建一个chunk</p><p>每个chunk都有至少两个属性：</p><ul><li>name：默认为main</li><li>id：唯一编号，开发环境和name相同，生产环境是一个数字，从0开始</li></ul><ol><li><strong>构建所有依赖模块</strong></li></ol><p><img src="/assets/编译流程-DpykDiTC.png" alt=""></p><ol start="2"><li><strong>产生chunk assets</strong></li></ol><p>在第二步完成后，chunk中会产生一个模块列表，列表中包含了<strong>模块id</strong>和<strong>模块转换后的代码</strong></p><p>接下来，webpack会根据配置为chunk生成一个资源列表，即<code>chunk assets</code>，资源列表可以理解为是生成到最终文件的文件名和文件内容</p><p><img src="/assets/chunkassets-D3ZDU8-M.png" alt=""></p><blockquote><p>chunk hash是根据所有chunk assets的内容生成的一个hash字符串 hash：一种算法，具体有很多分类，特点是将一个任意长度的字符串转换为一个固定长度的字符串，而且可以保证原始内容不变，产生的hash字符串就不变</p></blockquote><ol><li><strong>合并chunk assets</strong></li></ol><p>将多个chunk的assets合并到一起，并产生一个总的hash</p><p><img src="/assets/合并-Ccd15bqx.png" alt=""></p><h1 id="输出" tabindex="-1"><a class="header-anchor" href="#输出"><span>输出</span></a></h1><p>此步骤非常简单，webpack将利用node中的fs模块（文件处理模块），根据编译产生的总的assets，生成相应的文件。</p><p><img src="/assets/输出-CfNUo7qX.png" alt=""></p><h1 id="总过程" tabindex="-1"><a class="header-anchor" href="#总过程"><span>总过程</span></a></h1><p><img src="/assets/构建全流程-BIFBZo1U.png" alt=""></p><p><strong>涉及术语</strong></p><ol><li>module：模块，分割的代码单元，webpack中的模块可以是任何内容的文件，不仅限于JS</li><li>chunk：webpack内部构建模块的块，一个chunk中包含多个模块，这些模块是从入口模块通过依赖分析得来的</li><li>bundle：chunk构建好模块后会生成chunk的资源清单，清单中的每一项就是一个bundle，可以认为bundle就是最终生成的文件</li><li>hash：最终的资源清单所有内容联合生成的hash值</li><li>chunkhash：chunk生成的资源清单内容联合生成的hash值</li><li>chunkname：chunk的名称，如果没有配置则使用main</li><li>id：通常指chunk的唯一编号，如果在开发环境下构建，和chunkname相同；如果是生产环境下构建，则使用一个从0开始的数字进行编号</li></ol></div><footer class="page-footer" data-v-6df22fc2 data-v-f65adbd3><!----><!----><nav class="prev-next" data-v-f65adbd3><div class="pager" data-v-f65adbd3><a class="auto-link link pager-link prev" href="/article/r6yfi0qu/" data-v-f65adbd3 data-v-92ad409b><!--[--><span class="desc" data-v-f65adbd3>Previous page</span><span class="title" data-v-f65adbd3>ESM与CJS的区别</span><!--]--><!----></a></div><div class="pager" data-v-f65adbd3><a class="auto-link link pager-link next" href="/article/l44rtx2y/" data-v-f65adbd3 data-v-92ad409b><!--[--><span class="desc" data-v-f65adbd3>Next page</span><span class="title" data-v-f65adbd3>浏览器是如何工作的？</span><!--]--><!----></a></div></nav></footer><!----><!--]--></main></div></div></div></div><button style="display:none;" type="button" class="back-to-top-button" aria-label="back to top" data-v-ccde5b38 data-v-3a253c4a><span class="percent" data-v-3a253c4a>0%</span><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewbox="0 0 48 48" class="icon show" data-v-3a253c4a><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M24.008 14.1V42M12 26l12-12l12 12M12 6h24"></path></svg><svg aria-hidden="true" data-v-3a253c4a><circle cx="50%" cy="50%" style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-3a253c4a></circle></svg></button><footer class="plume-footer" data-v-ccde5b38 data-v-ebc9d2ec><div class="container" data-v-ebc9d2ec><p class="message" data-v-ebc9d2ec>Power by <a target="_blank" href="https://v2.vuepress.vuejs.org/">VuePress</a> & <a target="_blank" href="https://github.com/pengzhanbo/vuepress-theme-plume">vuepress-theme-plume</a></p><!----></div></footer><!--]--></div><!--]--></div><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-CVXxSXU1.js" defer></script></body></html>